{
	"name": "msxlead",
	"properties": {
		"folder": {
			"name": "IOT Engagments"
		},
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"linkedService": {
						"referenceName": "msxdatalake",
						"type": "LinkedServiceReference"
					},
					"name": "source1"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "msxlead",
						"type": "DatasetReference"
					},
					"name": "sink1"
				}
			],
			"transformations": [
				{
					"name": "Select1"
				},
				{
					"name": "Filter1"
				}
			],
			"script": "source(output(\n\t\tLeadId as string,\n\t\tAntipiracyEngagementTypeId as string,\n\t\tCampaignId as string,\n\t\tOwnerId as string,\n\t\tParentAccountId as string,\n\t\tParentContactId as string,\n\t\tPartnerAccountId as string,\n\t\tServicePracticeId as string,\n\t\tCurrencyId as string,\n\t\tBudgetStatusCode as integer,\n\t\tBudgetStatus as string,\n\t\tBudgetStatusSeqNo as long,\n\t\tLeadQualityCode as integer,\n\t\tLeadRating as string,\n\t\tLeadRatingSeqNo as long,\n\t\tLeadSourceCode as integer,\n\t\tLeadSource as string,\n\t\tLeadSourceSeqNo as long,\n\t\tPreferredContactMethodCode as integer,\n\t\tPreferredMethodOfContact as string,\n\t\tPreferredMethodOfContactSeqNo as long,\n\t\tPrimaryProductCode as integer,\n\t\tPrimaryProductRevSumDivision as string,\n\t\tPrimaryProductRevSumDivisionSeqNo as long,\n\t\tPurchaseTimeFrameCode as integer,\n\t\tPurchaseTimeFrame as string,\n\t\tPurchaseTimeFrameSeqNo as long,\n\t\tSourceSubTypeCode as integer,\n\t\tSourceSubType as string,\n\t\tSourceSubTypeSeqNo as long,\n\t\tAddress1_AddressId as string,\n\t\tCity as string,\n\t\tCountryOrRegion as string,\n\t\tStreet1 as string,\n\t\tStreet2 as string,\n\t\tStreet3 as string,\n\t\tZIPOrPostalCode as string,\n\t\tStateOrProvince as string,\n\t\tBudgetAmount as double,\n\t\tCompanyName as string,\n\t\tIsCustomerAgreementSecured as boolean,\n\t\tDescription as string,\n\t\tEstimatedValue as double,\n\t\tEstimatedCloseDate as timestamp,\n\t\tEstimatedQuantity as integer,\n\t\tIsInternalAgreementSecured as boolean,\n\t\tJobTitle as string,\n\t\tLeadNumber as string,\n\t\tIsPartnerFundingSecured as boolean,\n\t\tSubject as string,\n\t\tWebsiteUrl as string,\n\t\tWWLMResponseId as string,\n\t\tDoNotAllowBusinessPhoneCode as integer,\n\t\tDoNotAllowBusinessPhone as string,\n\t\tDoNotAllowBusinessPhoneSeqNo as long,\n\t\tDoNotAllowBusinessPhoneModifiedOn as timestamp,\n\t\tDoNotAllowEmailCode as integer,\n\t\tDoNotAllowEmail as string,\n\t\tDoNotAllowEmailSeqNo as long,\n\t\tDoNotAllowEmailModifiedOn as timestamp,\n\t\tDoNotAllowFaxCode as integer,\n\t\tDoNotAllowFax as string,\n\t\tDoNotAllowFaxSeqNo as long,\n\t\tDoNotAllowFaxModifiedOn as timestamp,\n\t\tDoNotAllowMailCode as integer,\n\t\tDoNotAllowMail as string,\n\t\tDoNotAllowMailSeqNo as long,\n\t\tDoNotAllowMailModifiedOn as timestamp,\n\t\tDoNotAllowMobilePhoneCode as integer,\n\t\tDoNotAllowMobilePhone as string,\n\t\tDoNotAllowMobilePhoneSeqNo as long,\n\t\tDoNotAllowMobilePhoneModifiedOn as timestamp,\n\t\tDoNotAllowPartnerBusinessPhoneCode as integer,\n\t\tDoNotAllowPartnerBusinessPhone as string,\n\t\tDoNotAllowPartnerBusinessPhoneSeqNo as long,\n\t\tDoNotAllowPartnerBusinessPhoneModifiedOn as timestamp,\n\t\tDoNotAllowPartnerEmailCode as integer,\n\t\tDoNotAllowPartnerEmail as string,\n\t\tDoNotAllowPartnerEmailSeqNo as long,\n\t\tDoNotAllowPartnerEmailModifiedOn as timestamp,\n\t\tDoNotAllowPartnerMailCode as integer,\n\t\tDoNotAllowPartnerMail as string,\n\t\tDoNotAllowPartnerMailSeqNo as long,\n\t\tDoNotAllowPartnerMailModifiedOn as timestamp,\n\t\tDoNotAllowPartnerMobilePhoneCode as integer,\n\t\tDoNotAllowPartnerMobilePhone as string,\n\t\tDoNotAllowPartnerMobilePhoneSeqNo as long,\n\t\tDoNotAllowPartnerMobilePhoneModifiedOn as timestamp,\n\t\tCrmInstanceId as string,\n\t\tCreatedById as string,\n\t\tCreatedDate as timestamp,\n\t\tModifiedById as string,\n\t\tModifiedDate as timestamp,\n\t\tStateCode as integer,\n\t\tStatus as string,\n\t\tStatusSeqNo as long,\n\t\tStatusCode as integer,\n\t\tStatusReason as string,\n\t\tStatusReasonSeqNo as long,\n\t\tOdsCreatedDate as timestamp,\n\t\tOdsModifiedDate as timestamp,\n\t\tVersionNumber as long,\n\t\tTenantId as integer,\n\t\tLeadScore as double,\n\t\tLeadTenantId as string,\n\t\tNumberOfDials as integer,\n\t\tcountrycode as integer,\n\t\tCountrySeqNo as long,\n\t\tCountry as string,\n\t\tPreferredLanguageCode as integer,\n\t\tPreferredLanguage as string,\n\t\tPreferredLanguageSeqNo as long,\n\t\tPriorityCode as integer,\n\t\tPriority as string,\n\t\tPrioritySeqNo as long,\n\t\tProductSKU as string,\n\t\tRegistrationDate as timestamp,\n\t\tSubscriptionId as string,\n\t\tPUID as string,\n\t\tLinkedInProfileURL as string,\n\t\tObjectID as string,\n\t\tNumberOfEmployees as integer,\n\t\tOriginatingTopic as string,\n\t\tPreferenceTypeCode as integer,\n\t\tPreferenceType as string,\n\t\tPreferenceTypeSeqNo as long,\n\t\tAnnualRevenue as double,\n\t\tFax as string,\n\t\tDialCount as integer,\n\t\tfieldacceptstatuscode as integer,\n\t\tfieldacceptstatus as string,\n\t\tfieldacceptstatusSeqNo as long,\n\t\troutetocode as integer,\n\t\trouteto as string,\n\t\troutetoSeqNo as long,\n\t\tsalesacceptleadcode as integer,\n\t\tsalesacceptlead as string,\n\t\tsalesacceptleadSeqNo as long,\n\t\tteleacceptleadcode as integer,\n\t\tteleacceptlead as string,\n\t\tteleacceptleadSeqNo as long,\n\t\tOdsStatus as integer,\n\t\tEngagementID as string,\n\t\tPrioritizationScore as double,\n\t\tAppSource as string,\n\t\tservicedivisioncode as integer,\n\t\tservicedivision as string,\n\t\tservicedivisionSeqNo as long,\n\t\tcssdispositioncode as integer,\n\t\tcssdispositionSeqNo as long,\n\t\tcssdisposition as string,\n\t\tdsraction as string,\n\t\tdsrdate as timestamp,\n\t\tdsrticket as string,\n\t\tstampstatuschange as timestamp,\n\t\towningBusinessUnit as string,\n\t\tcssworkflowcode as integer,\n\t\tcssworkflow as string,\n\t\tcssworkflowSeqNo as long,\n\t\tmicrosoftinternal as string,\n\t\tflagbusinessphonecode as integer,\n\t\tflagbusinessphone as string,\n\t\tflagbusinessphoneSeqNo as long,\n\t\tflagmobilephonecode as integer,\n\t\tflagmobilephone as string,\n\t\tflagmobilephoneSeqNo as long,\n\t\tPID as string,\n\t\tcompetethreatlevelcode as integer,\n\t\tcompetethreatlevel as string,\n\t\tcompetethreatlevelSeqNo as long,\n\t\tothercompetitor as string,\n\t\tprimarycompetitor as string,\n\t\tratingexplanation as string,\n\t\tCurrentSalesStageModifiedOn as timestamp,\n\t\tPlatformCreatedDate as timestamp,\n\t\tPlatformModifiedDate as timestamp,\n\t\tPlatformModifiedDateAsInt as long,\n\t\tPartnerReferral as string,\n\t\thandraiser as boolean,\n\t\tfeedbackforcss as string,\n\t\tpricelevelid as string,\n\t\tOrderId as string,\n\t\tpaymenttypecode as integer,\n\t\tpaymenttype as string,\n\t\tpaymenttypeSeqNo as long,\n\t\textractid as string,\n\t\textractdatetime as timestamp,\n\t\tloadts as timestamp,\n\t\tdeltaactioncode as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false,\n\tformat: 'delta',\n\tfileSystem: 'cseo',\n\tfolderPath: 'standardized/transactional/msx/hub_vw_lead/v1/standard') ~> source1\nsource1 select(mapColumn(\n\t\tLeadId,\n\t\tPrimaryProductRevSumDivisionSeqNo,\n\t\tOdsStatus,\n\t\tLeadNumber\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> Select1\nSelect1 filter(OdsStatus==0 &&PrimaryProductRevSumDivisionSeqNo == 6239) ~> Filter1\nFilter1 sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tdeletable:false,\n\tinsertable:true,\n\tupdateable:false,\n\tupsertable:false,\n\trecreate:true,\n\tformat: 'table',\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\terrorHandlingOption: 'stopOnFirstError') ~> sink1"
		}
	}
}