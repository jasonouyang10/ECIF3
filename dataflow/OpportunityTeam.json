{
	"name": "OpportunityTeam",
	"properties": {
		"folder": {
			"name": "GBB Opportunity"
		},
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"linkedService": {
						"referenceName": "msxdatalake",
						"type": "LinkedServiceReference"
					},
					"name": "OpportunityTeamTeam"
				},
				{
					"dataset": {
						"referenceName": "MSXOpportunity",
						"type": "DatasetReference"
					},
					"name": "Opportunity"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "MSXOpportunityTeam",
						"type": "DatasetReference"
					},
					"name": "sink1"
				}
			],
			"transformations": [
				{
					"name": "Filter1"
				},
				{
					"name": "existsInOpp"
				}
			],
			"script": "source(output(\n\t\tEDLPExtractId as string,\n\t\tCreatedById as string,\n\t\tCreatedDate as timestamp,\n\t\tCrmInstanceId as string,\n\t\tModifiedById as string,\n\t\tModifiedDate as timestamp,\n\t\tOdsCreatedDate as timestamp,\n\t\tOdsModifiedDate as timestamp,\n\t\tOdsStatus as integer,\n\t\tOpportunityId as string,\n\t\tOpportunityTeamId as integer,\n\t\tSystemUserId as string,\n\t\tTenantId as integer,\n\t\tVersionNumber as long,\n\t\tTeamId as string,\n\t\tEDLPExtractDateTime as timestamp,\n\t\tEDLPLoadTS as string,\n\t\tEDLPModifiedDateTime as timestamp,\n\t\tEDLPDeltaActionCode as string,\n\t\tExtractId as string,\n\t\tExtractDateTime as timestamp,\n\t\tLoadTS as timestamp,\n\t\tDeltaActionCode as string,\n\t\tPlatformCreatedDate as timestamp,\n\t\tPlatformModifiedDate as timestamp,\n\t\tPlatformModifiedDateAsInt as long\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false,\n\tformat: 'delta',\n\tfileSystem: 'cseo',\n\tfolderPath: 'standardized/transactional/msx/hub_vw_opportunityteam/v1/standard') ~> OpportunityTeamTeam\nsource(output(\n\t\tEDLPExtractId as string,\n\t\taccessecif as string,\n\t\taccessecifcode as integer,\n\t\taccessecifSeqNo as long,\n\t\tAccountId as string,\n\t\tActualCloseDate as timestamp,\n\t\tActualvalue as double,\n\t\tAdhocSurvey as integer,\n\t\tAgreedToBuy as boolean,\n\t\talignonbusinessimpactSeqNo as long,\n\t\talignonsolutionapproachSeqNo as long,\n\t\tAntipiracyEngagementTypeId as string,\n\t\tattachedservices as boolean,\n\t\tbaseopportunity as string,\n\t\tbaseopportunitycode as integer,\n\t\tbaseopportunitySeqNo as long,\n\t\tBilledRevenue as double,\n\t\tbizappssalesplay as string,\n\t\tbizappssalesplaycode as integer,\n\t\tbizappssalesplaySeqNo as long,\n\t\tBudgetAmount as double,\n\t\tCampaignId as string,\n\t\tClaimTPID as string,\n\t\tclanumber as string,\n\t\tcloseplan as string,\n\t\tclosestatus as string,\n\t\tclosestatuscode as integer,\n\t\tclosestatusSeqNo as long,\n\t\tcommercialconstructapprovedbycustomer as string,\n\t\tcommercialconstructapprovedbycustomercode as integer,\n\t\tcommercialconstructapprovedbycustomerSeqNo as long,\n\t\tcompetethreatlevel as string,\n\t\tcompetethreatlevelcode as integer,\n\t\tcompetethreatlevelSeqNo as long,\n\t\tCompleteClosePlan as boolean,\n\t\tCompleteDeploymentWorkshop as timestamp,\n\t\tCompleteFinalProposal as boolean,\n\t\tcompletejointcatalystengagementplan as string,\n\t\tcompletejointcatalystengagementplancode as integer,\n\t\tcompletejointcatalystengagementplanSeqNo as long,\n\t\tcompletepredeploymentworkshopSeqNo as long,\n\t\tcompletetechnicalassessment as string,\n\t\tcompletetechnicalassessmentcode as integer,\n\t\tcompletetechnicalassessmentSeqNo as long,\n\t\tCompleteTechnicalClosePlan as timestamp,\n\t\tcompletetrialSeqNo as long,\n\t\tCompleteWorkshop as timestamp,\n\t\tcomplexity as string,\n\t\tcomplexitycode as integer,\n\t\tcomplexitySeqNo as long,\n\t\tconductpocSeqNo as long,\n\t\tConfirmTrial as timestamp,\n\t\tConsentToSendToPartner as string,\n\t\tConsentToSendToPartnerBy as string,\n\t\tConsentToSendToPartnerCode as integer,\n\t\tConsentToSendToPartnerSeqNo as long,\n\t\tcontractsignaturetype as string,\n\t\tcontractsignaturetypecode as integer,\n\t\tcontractsignaturetypeSeqNo as long,\n\t\tcorrectedecid as string,\n\t\tcosell as string,\n\t\tcosellcode as integer,\n\t\tcosellSeqNo as long,\n\t\tcpumodelseries as string,\n\t\tcpumodelseriescode as integer,\n\t\tcpumodelseriesSeqNo as long,\n\t\tcreatebusinessvalueassessment as string,\n\t\tcreatebusinessvalueassessmentcode as integer,\n\t\tcreatebusinessvalueassessmentSeqNo as long,\n\t\tCreatedById as string,\n\t\tCreatedDate as timestamp,\n\t\tCriticalDeal as boolean,\n\t\tCrmInstanceId as string,\n\t\tCurrencyId as string,\n\t\tCurrentSalesStageModifiedOn as timestamp,\n\t\tcustomersignoffonassessments as string,\n\t\tcustomersignoffonassessmentscode as integer,\n\t\tcustomersignoffonassessmentsSeqNo as long,\n\t\tcustomersuccessplanworkshopcomplete as string,\n\t\tcustomersuccessplanworkshopcompletecode as integer,\n\t\tcustomersuccessplanworkshopcompleteSeqNo as long,\n\t\tdealtype as string,\n\t\tdealtypecode as integer,\n\t\tdealtypeSeqNo as long,\n\t\tdeliverbusinessvalueenlighten as string,\n\t\tdeliverbusinessvalueenlightencode as integer,\n\t\tdeliverbusinessvalueenlightenSeqNo as long,\n\t\tdeliverenvisioningworkshop as string,\n\t\tdeliverenvisioningworkshopcode as integer,\n\t\tdeliverenvisioningworkshopSeqNo as long,\n\t\tdeliverinitialpitch as string,\n\t\tdeliverinitialpitchcode as integer,\n\t\tdeliverinitialpitchSeqNo as long,\n\t\tdelivertailoreddemonstration as string,\n\t\tdelivertailoreddemonstrationcode as integer,\n\t\tdelivertailoreddemonstrationSeqNo as long,\n\t\tdelivertechnicalcase as string,\n\t\tdelivertechnicalcasecode as integer,\n\t\tdelivertechnicalcaseSeqNo as long,\n\t\tdelivertransformationplan as string,\n\t\tdelivertransformationplancode as integer,\n\t\tdelivertransformationplanSeqNo as long,\n\t\tdemonstrateroi as string,\n\t\tdemonstrateroicode as integer,\n\t\tdemonstrateroiSeqNo as long,\n\t\tdevicecategory as string,\n\t\tdevicecategorycode as integer,\n\t\tdevicecategorySeqNo as long,\n\t\tengagecosellprioritizedpartnerSeqNo as long,\n\t\tengagedwrawrforecif as string,\n\t\tengagedwrawrforecifcode as integer,\n\t\tengagedwrawrforecifSeqNo as long,\n\t\tengagefasttrack as string,\n\t\tengagefasttrackcode as integer,\n\t\tengagefasttrackSeqNo as long,\n\t\tengagegbb as string,\n\t\tengagegbbcode as integer,\n\t\tengagegbbSeqNo as long,\n\t\tengagemicrosoftexecutivewithcustomercxo as string,\n\t\tengagemicrosoftexecutivewithcustomercxocode as integer,\n\t\tengagemicrosoftexecutivewithcustomercxoSeqNo as long,\n\t\tEngageServices as string,\n\t\tEnrollmentNumber as string,\n\t\tEstimatedCloseDate as timestamp,\n\t\tEstimatedValue as double,\n\t\tEstROCArrivalDate as timestamp,\n\t\tEvaluationPlan as boolean,\n\t\texecutedigitalimmersionSeqNo as long,\n\t\tFinalConsumptionPlan as boolean,\n\t\tfinaldecisiondate as timestamp,\n\t\tForecastComments as string,\n\t\tForecastComments_LastModifiedBy_Lookup as string,\n\t\tForecastComments_LastModifiedOn_DateTime as timestamp,\n\t\tHandovertoCSMorPCSM as boolean,\n\t\tHasCustomerAgreedToBuy as boolean,\n\t\tHighLevelSolutionDesign as boolean,\n\t\tidentifybusinessdecisionmakersSeqNo as long,\n\t\tInitialBusinessCase as boolean,\n\t\tIsConclusionLetterSent as boolean,\n\t\tIsELPAgreementSecured as boolean,\n\t\tIsELPUploaded as boolean,\n\t\tIsIdentifyBuyingTeamComplete as boolean,\n\t\tIsIdentifyCompetitorsComplete as boolean,\n\t\tIsIdentifyLineItemsComplete as boolean,\n\t\tIsIdentifySalesTeamComplete as boolean,\n\t\tIsInternalAgreementSecured as boolean,\n\t\tIsLetterOfEngagementAccepted as boolean,\n\t\tIsOrderComplete as boolean,\n\t\tIsPartnerFundingSecured as boolean,\n\t\tIsPurchaseArrangementSecured as boolean,\n\t\tIsQuoteComplete as boolean,\n\t\tIsRevenueSystemCalculated as boolean,\n\t\tlastshipmentdate as timestamp,\n\t\tLicensingContact as string,\n\t\tLicensingProgramId as string,\n\t\tLSSODMComments as string,\n\t\tmicrosoftazureiotcertifieddevice as boolean,\n\t\tModifiedById as string,\n\t\tModifiedDate as timestamp,\n\t\tNeed as string,\n\t\tnewenrollmentnumber as string,\n\t\tNoofTenants as integer,\n\t\tNumberOfDials as integer,\n\t\tOdsCreatedDate as timestamp,\n\t\tOdsModifiedDate as timestamp,\n\t\tOdsStatus as integer,\n\t\toperationscontact as string,\n\t\tOpportunityCopyType as string,\n\t\tOpportunityCopyTypeCode as integer,\n\t\tOpportunityCopyTypeSeqNo as long,\n\t\tOpportunityId as string,\n\t\tOpportunityNumber as string,\n\t\tOpportunityScore as double,\n\t\tOpportunitySource as string,\n\t\tOpportunitySourceCode as integer,\n\t\tOpportunitySourceSeqNo as long,\n\t\tOpportunityTenantId as string,\n\t\tOriginalPartnerModifiedBy as string,\n\t\tOriginatingLeadId as string,\n\t\tOriginatingOpportunity as string,\n\t\tothercompetitor as string,\n\t\tOwnerId as string,\n\t\towningBusinessUnit as string,\n\t\tParentOpportunityId as string,\n\t\tPartnerAccountId as string,\n\t\tpartnermotion as string,\n\t\tpartnermotioncode as integer,\n\t\tpartnermotionSeqNo as long,\n\t\tPartnerReferral as string,\n\t\tpilotsolutionSeqNo as long,\n\t\tPrelimConsumptionPlan as boolean,\n\t\tpresentbusinesscaseSeqNo as long,\n\t\tpresentdealoptionsSeqNo as long,\n\t\tPriceLevelId as string,\n\t\tPricePointDetails as string,\n\t\tprimarycompetitor as string,\n\t\tPrimarySponsorContactId as string,\n\t\tPriority as string,\n\t\tPriorityCode as integer,\n\t\tPrioritySeqNo as long,\n\t\tProductSKU as string,\n\t\tPullForwardDate as timestamp,\n\t\tPurchaseTimeFrame as string,\n\t\tPurchaseTimeFrameCode as integer,\n\t\tPurchaseTimeFrameSeqNo as long,\n\t\tRapidResponse as boolean,\n\t\tRecommendation as string,\n\t\tRecommendationCode as integer,\n\t\tRecommendationSeqNo as long,\n\t\tRegistrationDate as timestamp,\n\t\trvtstatus as string,\n\t\trvtstatuscode as integer,\n\t\trvtstatusSeqNo as long,\n\t\trvtvalidationready as boolean,\n\t\tsalesplay as string,\n\t\tsalesplaySeqNo as long,\n\t\tselectsalesplay as string,\n\t\tselectsalesplaycode as integer,\n\t\tselectsalesplaySeqNo as long,\n\t\tSendToPartner as boolean,\n\t\tsharebompricing as string,\n\t\tsharebompricingcode as integer,\n\t\tsharebompricingSeqNo as long,\n\t\tsolutionarea as string,\n\t\tsolutionareaSeqNo as long,\n\t\tsolutiondesignindate as timestamp,\n\t\tsolutionstartdate as timestamp,\n\t\tSourceSubType as string,\n\t\tSourceSubTypeCode as integer,\n\t\tSourceSubTypeSeqNo as long,\n\t\tStateCode as integer,\n\t\tStatus as string,\n\t\tStatusCode as integer,\n\t\tStatusReason as string,\n\t\tStatusReasonSeqNo as long,\n\t\tStatusSeqNo as long,\n\t\tSubscriptionId as string,\n\t\tSurveyResponseRejectionCounts as integer,\n\t\ttechnicalcapability as string,\n\t\ttechnicalcapabilitySeqNo as long,\n\t\tTenantId as integer,\n\t\tTopic as string,\n\t\ttransactiontype as string,\n\t\ttransactiontypecode as integer,\n\t\ttransactiontypeSeqNo as long,\n\t\ttransitiontocsupartnerSeqNo as long,\n\t\tVersionNumber as long,\n\t\talignonbusinessimpactcode as integer,\n\t\talignonsolutionapproachcode as integer,\n\t\tcompletepredeploymentworkshopcode as integer,\n\t\tcompletetrialcode as integer,\n\t\tconductpoccode as integer,\n\t\tengagecosellprioritizedpartnercode as integer,\n\t\texecutedigitalimmersioncode as integer,\n\t\tidentifybusinessdecisionmakerscode as integer,\n\t\tpilotsolutioncode as integer,\n\t\tpresentbusinesscasecode as integer,\n\t\tpresentdealoptionscode as integer,\n\t\tsalesplaycode as integer,\n\t\tsolutionareacode as integer,\n\t\ttechnicalcapabilitycode as integer,\n\t\ttransitiontocsupartnercode as integer,\n\t\tAgreement as string,\n\t\tAgreementToProceedToContractNegotiation as boolean,\n\t\tConfirmTimelineAndBudgetStatus as boolean,\n\t\tCustomerAgreesSolutionIsTechnicallyViable as boolean,\n\t\tCustomerAgreesToPerformAProofOfConcept as boolean,\n\t\tCustomerAgreesWithMSValueProposition as boolean,\n\t\tCustomerApprovesBusinessCaseFramework as boolean,\n\t\tCustomerApprovesTechnicalCriteria as boolean,\n\t\tCustomerSignsContractOrAgreesToPlaceOrder as boolean,\n\t\tdemandresponsedealtype as string,\n\t\tdemandresponsedealtypecode as integer,\n\t\tIdentifyBuyingTeamStakeholders as boolean,\n\t\tInvoice as string,\n\t\tPresentCustomerWithFinalValueCaseProposal as boolean,\n\t\tActiveProcess as string,\n\t\tActiveSalesStage as string,\n\t\tActualBilledCloseDate as timestamp,\n\t\tActualConsumptionCloseDate as timestamp,\n\t\tAzureActiveDevicesNonRecurring as integer,\n\t\tAzureActiveDevicesRecurring as decimal(10,0),\n\t\tAzureConsumedNonRecurring as decimal(10,0),\n\t\tAzureConsumedNonRecurringBase as decimal(10,0),\n\t\tAzureConsumedRecurring as decimal(10,0),\n\t\tAzureConsumedRecurringBase as decimal(10,0),\n\t\tBilledClosingComments as string,\n\t\tBilledRevenueCloseReason as integer,\n\t\tBilledRevenueStatus as integer,\n\t\tBilledActualRevenueBase as decimal(10,0),\n\t\tBizAppsActiveDevicesNonRecurring as decimal(10,0),\n\t\tBizAppsActiveDevicesRecurring as decimal(10,0),\n\t\tBizAppsBACVNonRecurring as decimal(10,0),\n\t\tBizAppsBACVNonRecurringBase as decimal(10,0),\n\t\tBizAppsBACVRecurring as decimal(10,0),\n\t\tBizAppsBACVRecurringBase as decimal(10,0),\n\t\tConsumptionClosingComments as string,\n\t\tConsumptionStatus as integer,\n\t\tConsumptionStatusReason as integer,\n\t\tCustomerAgreementInPlace as integer,\n\t\tDesignAgreedWithCustomer as integer,\n\t\tEngagementNarrative as string,\n\t\tEngagementNextSteps as string,\n\t\tEstStartDate as timestamp,\n\t\tEstCompletionDate as timestamp,\n\t\tMigratedEngagementId as string,\n\t\tMigratedEngagementNumber as string,\n\t\tMilestonesFlag as string,\n\t\tOpportunityCompletedAndNextStepsIdentified as integer,\n\t\tOpportunityType as string,\n\t\tOutcomesMetAndBaselineMetricsInPlace as integer,\n\t\tProductFlags as string,\n\t\tQualifiedOpportunity as integer,\n\t\tSecurityActiveDevicesNonRecurring as decimal(10,0),\n\t\tSecurityActiveDevicesRecurring as decimal(10,0),\n\t\tSecurityConsumedNonRecurring as decimal(10,0),\n\t\tSecurityConsumedNonRecurringBase as decimal(10,0),\n\t\tSecurityConsumedRecurring as decimal(10,0),\n\t\tSecurityConsumedRecurringBase as decimal(10,0),\n\t\tAzureCapacityType as string,\n\t\tPreferredAzureRegion as integer,\n\t\tInitialStakeholderIdentificationComplete as integer,\n\t\tCustomerNeedsAndOutcomesDefine as integer,\n\t\tCustomerPrioritiesIdentified as integer,\n\t\tSolutionPlaysConfirmedDealTeamOrchest as integer,\n\t\tPartnersIdentifiedAndEngaged as integer,\n\t\tBusinessValueConsiderationsCompleted as integer,\n\t\tSolutionDesignValidatedWithCustomer as integer,\n\t\tTechnicalBusinessProofRequirementSide as integer,\n\t\tCustomersignedoffonproposesolution as integer,\n\t\tCustomerSuccessPlanReviewedWithCustomer as integer,\n\t\tCustomerCommitToProposal as integer,\n\t\tResourcesAlignAgainstDeliveryPlan as integer,\n\t\tChangeManagementPlanPlace as integer,\n\t\tSolutionDeliveredAgainstAgreedOutcome as integer,\n\t\tCustomerHealthMetricsAgreedWithMonitoring as integer,\n\t\tNextSetOfCustomerNeedsIdentify as integer,\n\t\tBusValueAndSuccessOutcomeMonitoringInPlac as integer,\n\t\tCustomerCanOperateAndMaintainSolution as integer,\n\t\tMigratedEngagementCreatedBy as string,\n\t\tCustomerSuccessPlanUpdated as integer,\n\t\tEDLPExtractDateTime as timestamp,\n\t\tEDLPLoadTS as string,\n\t\tEDLPModifiedDateTime as timestamp,\n\t\tEDLPDeltaActionCode as string,\n\t\tConsumedRecurring as decimal(10,0),\n\t\tConsumedRecurringBase as decimal(10,0),\n\t\tConsumedNonRecurring as decimal(10,0),\n\t\tConsumedNonRecurringBase as decimal(10,0),\n\t\tConsumptionActiveDevicesRecurring as decimal(10,0),\n\t\tConsumptionActiveDevicesNonRecurring as decimal(10,0),\n\t\tModernConsumedRecurring as decimal(10,0),\n\t\tModernConsumedRecurringBase as decimal(10,0),\n\t\tModernConsumedNonRecurring as decimal(10,0),\n\t\tModernConsumedNonRecurringBase as decimal(10,0),\n\t\tModernActiveDevicesRecurring as decimal(10,0),\n\t\tModernActiveDevicesNonRecurring as decimal(10,0),\n\t\tRiskScore as decimal(10,5)\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tisolationLevel: 'READ_UNCOMMITTED',\n\tformat: 'table') ~> Opportunity\nexistsInOpp filter(OdsStatus==0) ~> Filter1\nOpportunityTeamTeam, Opportunity exists(OpportunityTeamTeam@OpportunityId == Opportunity@OpportunityId,\n\tnegate:false,\n\tbroadcast: 'auto')~> existsInOpp\nFilter1 sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tdeletable:false,\n\tinsertable:true,\n\tupdateable:false,\n\tupsertable:false,\n\trecreate:true,\n\tformat: 'table',\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\terrorHandlingOption: 'stopOnFirstError') ~> sink1"
		}
	}
}