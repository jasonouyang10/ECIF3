{
	"name": "Step2 OpportunityTeam",
	"properties": {
		"folder": {
			"name": "InProgress Opp"
		},
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"linkedService": {
						"referenceName": "msxdatalake",
						"type": "LinkedServiceReference"
					},
					"name": "MSXOpportunityTeam"
				},
				{
					"dataset": {
						"referenceName": "MSXOpportunityInProgress",
						"type": "DatasetReference"
					},
					"name": "InProgressOpp"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "InProgressOpportunityTeam",
						"type": "DatasetReference"
					},
					"name": "OpportunityTeam"
				}
			],
			"transformations": [
				{
					"name": "asOpportunityObject"
				},
				{
					"name": "exists2"
				}
			],
			"script": "source(output(\n\t\tEDLPExtractId as string,\n\t\tAdministratorId as string,\n\t\tBusinessUnitId as string,\n\t\tCreatedById as string,\n\t\tCreatedDate as timestamp,\n\t\tCrmInstanceId as string,\n\t\tDescription as string,\n\t\tModifiedById as string,\n\t\tModifiedDate as timestamp,\n\t\tOdsCreatedDate as timestamp,\n\t\tOdsModifiedDate as timestamp,\n\t\tOdsStatus as integer,\n\t\tSystemManaged as boolean,\n\t\tTeam as string,\n\t\tTeamId as string,\n\t\tTeamType as string,\n\t\tTeamTypeCode as integer,\n\t\tTeamTypeSeqNo as long,\n\t\tTenantId as integer,\n\t\tTransactionCurrencyId as string,\n\t\tVersionNumber as long,\n\t\tId as string,\n\t\tmembershiptype as long,\n\t\tisdefault as boolean,\n\t\tmodifiedonbehalfby as string,\n\t\tmodifiedonbehalfby_entitytype as string,\n\t\tqueueid as string,\n\t\tqueueid_entitytype as string,\n\t\tcreatedonbehalfby as string,\n\t\tcreatedonbehalfby_entitytype as string,\n\t\ttransactioncurrencyid_entitytype as string,\n\t\tregardingobjectid as string,\n\t\tadministratorid_entitytype as string,\n\t\tbusinessunitid_entitytype as string,\n\t\tmodifiedby_entitytype as string,\n\t\tcreatedby_entitytype as string,\n\t\tteamtemplateid as string,\n\t\tteamtemplateid_entitytype as string,\n\t\ttraversedpath as string,\n\t\ttransactioncurrencyidname as string,\n\t\tqueueidname as string,\n\t\tregardingobjecttypecode as string,\n\t\tstageid as string,\n\t\timportsequencenumber as long,\n\t\torganizationidname as string,\n\t\tazureactivedirectoryobjectid as string,\n\t\tadministratoridname as string,\n\t\tadministratoridyominame as string,\n\t\texchangerate as decimal(10,0),\n\t\tprocessid as string,\n\t\tbusinessunitidname as string,\n\t\toverriddencreatedon as timestamp,\n\t\tregardingobjectid_entitytype as string,\n\t\tEDLPExtractDateTime as timestamp,\n\t\tEDLPLoadTS as string,\n\t\tEDLPModifiedDateTime as timestamp,\n\t\tEDLPDeltaActionCode as string,\n\t\tExtractId as string,\n\t\tExtractDateTime as timestamp,\n\t\tLoadTS as timestamp,\n\t\tDeltaActionCode as string,\n\t\tPlatformCreatedDate as timestamp,\n\t\tPlatformModifiedDate as timestamp,\n\t\tPlatformModifiedDateAsInt as long\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false,\n\tformat: 'delta',\n\tfileSystem: 'cseo',\n\tfolderPath: 'standardized/transactional/msx/hub_vw_team/v1/standard') ~> MSXOpportunityTeam\nsource(output(\n\t\topportunityid as string,\n\t\topportunitynumber as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tisolationLevel: 'READ_UNCOMMITTED',\n\tformat: 'table') ~> InProgressOpp\nexists2 filter(lower(regardingobjectid_entitytype)=='opportunity') ~> asOpportunityObject\nMSXOpportunityTeam, InProgressOpp exists(regardingobjectid == opportunityid,\n\tnegate:false,\n\tbroadcast: 'auto')~> exists2\nasOpportunityObject sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tinput(\n\t\tEDLPExtractId as string,\n\t\tCreatedById as string,\n\t\tCreatedDate as timestamp,\n\t\tCrmInstanceId as string,\n\t\tModifiedById as string,\n\t\tModifiedDate as timestamp,\n\t\tOdsCreatedDate as timestamp,\n\t\tOdsModifiedDate as timestamp,\n\t\tOdsStatus as integer,\n\t\tOpportunityId as string,\n\t\tOpportunityTeamId as integer,\n\t\tSystemUserId as string,\n\t\tTenantId as integer,\n\t\tVersionNumber as long,\n\t\tTeamId as string,\n\t\tEDLPExtractDateTime as timestamp,\n\t\tEDLPLoadTS as string,\n\t\tEDLPModifiedDateTime as timestamp,\n\t\tEDLPDeltaActionCode as string,\n\t\tExtractId as string,\n\t\tExtractDateTime as timestamp,\n\t\tLoadTS as timestamp,\n\t\tDeltaActionCode as string,\n\t\tPlatformCreatedDate as timestamp,\n\t\tPlatformModifiedDate as timestamp,\n\t\tPlatformModifiedDateAsInt as long\n\t),\n\tdeletable:false,\n\tinsertable:true,\n\tupdateable:false,\n\tupsertable:false,\n\trecreate:true,\n\tformat: 'table',\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\terrorHandlingOption: 'stopOnFirstError') ~> OpportunityTeam"
		}
	}
}